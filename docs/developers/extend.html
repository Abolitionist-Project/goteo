<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Goteo Developer&#039;s Documentation</title>

        <link rel="stylesheet" href="http://goteofoundation.github.io/goteo/css/bootstrap.min.css">
        <link rel="stylesheet" href="http://goteofoundation.github.io/goteo/css/font-awesome.min.css">
        <link rel="stylesheet" href="http://goteofoundation.github.io/goteo/css/main.css">
        <link rel="stylesheet" href="http://goteofoundation.github.io/goteo/css/goteo.css">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
        <link rel="stylesheet" href="http://goteofoundation.github.io/goteo/highlight/styles/monokai.css">

    </head>
    <body>

        <header class="navbar navbar-default navbar-fixed-top">

            <a class="navbar-brand" href="http://goteofoundation.github.io/goteo/">
                Goteo Developer&#039;s Documentation
                <small class="hidden-xs hidden-sm">
                    An opensource crowdfunding platform made with PHP
                </small>
            </a>

                            <a href="https://github.com/goteofoundation/goteo">
                    <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png">
                </a>
            
        </header>

        <main class="container-fluid">
            <div class="row">

                
                    <nav id="sidebar" class="col-sm-3 col-lg-2" role="navigation">

                                                    <p class="text-muted">
                                Main documentation
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="http://goteofoundation.github.io/goteo/index.html">
                                            About
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://goteofoundation.github.io/goteo/docs/install.html">
                                            Install
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://goteofoundation.github.io/goteo/docs/upgrade.html">
                                            Upgrade
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://goteofoundation.github.io/goteo/docs/console.html">
                                            Console scripts
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                Developers
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="http://goteofoundation.github.io/goteo/docs/developers/environment.html">
                                            Environment
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://goteofoundation.github.io/goteo/docs/developers/templates.html">
                                            Template system
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://goteofoundation.github.io/goteo/docs/developers/migration.html">
                                            Legacy migration howto
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://goteofoundation.github.io/goteo/docs/developers/payments.html">
                                            Payment process
                                        </a>
                                    </li>
                                                                    <li class="active">
                                        <a href="http://goteofoundation.github.io/goteo/docs/developers/extend.html">
                                            Plugins & extending
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://goteofoundation.github.io/goteo/docs/developers/events.html">
                                            Using events
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://goteofoundation.github.io/goteo/docs/developers/consoledev.html">
                                            Extending console
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                About
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="http://goteofoundation.github.io/goteo/release_notes.html">
                                            Release notes
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://goteofoundation.github.io/goteo/LICENSE">
                                            License
                                        </a>
                                    </li>
                                                            </ul>
                        
                    </nav>

                
                <section class="col-sm-offset-3 col-lg-offset-2 col-sm-9 col-lg-10">
                    <h1 id="extending-goteo">Extending Goteo</h1>
<p>Plugins can extend or modify almost any aspect of the site.</p>
<h2 id="the-plugins-folder">The plugins' folder</h2>
<p>Take as an example <strong>goteo-dev</strong></p>
<p>Plugins must be enabled in config/settings.yml, like this:</p>
<pre><code class="language-yaml">plugins:
    plugin-name:
        active: true
        ... #optional custom configuration directives</code></pre>
<h3 id="directory-structure">Directory structure:</h3>
<p>All plugins must follow this structure (inside the <code>extend</code> folder):</p>
<pre><code>extend/
└── plugin-name
    ├── start.php         &lt;- Mandatory, Will be called on app init
    ├── manifest.yml      &lt;- Mandatory, Should specify name, version
    ├── README.md         &lt;- Optional
    │── src/
    │   └── Vendor/
    │       └── Foo/
    │           └── Bar.php
    │
    └── Resources/       &lt;- Optional
        ├── templates/   &lt;- Optional, templates will be searched here first
        ...
</code></pre>
<h3 id="the">The <code>manifest.yml</code> file:</h3>
<p>This file should follow this structure:</p>
<pre><code class="language-yaml"># ...Plugin description...
---

name: PluginName
version: 1.0

# Advanced/optional (don't write anything else in this file if you don't known what your are doing):
# Next key/value array will be used by Grunt to copy this files under the "dist/" directory

assets:
    # Will be copied as dist/plugin-name/assets
    Resources/assets: plugin-name/assets
    ...</code></pre>
<h3 id="the-1">The <code>start.php</code> file:</h3>
<p>Probably, the most common task to be achieved is to personalize the home page or any other view. A minimal start.php file should be something like this:</p>
<pre><code class="language-php">&lt;?php

// initial start.php can be empty, everything here is optional

use Goteo\Application\Config;
use Goteo\Application\Lang;

// Autoload additional Classes (if necessary)
Config::addAutoloadDir(__DIR__ .'/src');

// Adding lang files (if necessary)
Lang::addYamlTranslation('en', __DIR__ .'/my-translations/en/some-file.yml');

// ... other things...
</code></pre>
<p>Take a look at the file  <code>extend/goteo-dev/start.php</code>  as a more complex example.</p>
<p>The important part about creating a dummy plugin like this is that any view can be overwritten by just making a replacement in the same directory relative to your plugin folder.</p>
<p>For example, if you create a plugin named &quot;my-plugin&quot;, you can overwrite the file <code>Resources/templates/responsive/partials/footer.php</code> by creating the same file in the path <code>extend/my-plugin/Resources/templates/responsive/partials/footer.php</code></p>
<p>Basically, you'll end with a plugin directory structure like this:</p>
<pre><code>extend/
└── my-plugin
    ├── start.php
    ├── manifest.yml
    └── Resources/
        └── templates/
            └── responsive/
                └── partials/
                    └── footer.php
</code></pre>
<h2 id="example-a-test-plugin">Example, a test plugin</h2>
<p>This example will create a very simple plugin that adds a &quot;Call to action button&quot; in the home:</p>
<ol>
<li>Create a folder named <code>home-addons</code> in the folder <code>extend</code> where you have your copy of Goteo.</li>
</ol>
<p>We will create 2 files in that folder:</p>
<ol start="2">
<li>Create the <code>manifest.yml</code> file, that should be exactly like this:</li>
</ol>
<pre><code class="language-yaml">name: home-addons
version: 1.0</code></pre>
<p>(You don't need to specify any other resources for the moment: <em>start simple</em>).</p>
<ol start="3">
<li>Create the <code>start.php</code> file, something like this:</li>
</ol>
<pre><code class="language-php">&lt;?php
// plugin init file</code></pre>
<p>That's right, nothing in it...</p>
<p>Then you can start overwriting views, for example create this file:</p>
<p><code>extend/plugin-responsive/Resources/templates/responsive/home/partials/call_to_action.php</code></p>
<p>With this content:</p>
<pre><code class="language-html">&lt;div class="section call-action"&gt;
    &lt;div class="container"&gt;
        Check this out: &lt;a class="btn btn-lg btn-orange pull-right" href="www.goteo.org"&gt;Goteo rocks&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;</code></pre>
<p>Finally, activate the plugin in your <code>settings.yml</code>:</p>
<pre><code class="language-yaml">...
plugins:
    home-addons:
        active: true</code></pre>
<p>Now, you should view at the home page a nice cyan bar with the new content added.
This process can be repeated by adding more files with you custom content.</p>
<p>For example, you can create this file: <code>extend/plugin-responsive/Resources/templates/responsive/home/index.php</code> with anything you want in it and it will replace the default one. At this point you may want to check the <a href="http://goteofoundation.github.io/goteo/docs/developers/templates.html">templates section</a> and the <a href="https://foilphp.github.io/Foil/">Foil template documentation</a></p>
<h2 id="dev-plugin">Dev plugin</h2>
<p>There's a demo plugin with some utilities distributed with the code, the  <code>goteo-dev</code> plugin.
It adds a toolbar at the bottom of the page with debugging info.
Also, it provides a useful command line that can be used to create testing situations:</p>
<pre><code class="language-bash">./bin/console dev:statusinit -h</code></pre>
<pre><code>Help:
 This script initializes projects, invests and users to some known status in order to allow tests

 Usage:

 Run the SQL scripts to initialize status
 ./bin/console dev:statusinit

 Run the SQL scripts to initialize status with published, passed and closed dates
 so it can be used to test the endround (and others such as projectwatch) command

 One day succeeded, published or failed projects:
 ./bin/console dev:statusinit --delta 1

 Ten days succeeded, published or failed projects:
 ./bin/console dev:statusinit --delta 10

 Removes all testing data:
 ./bin/console dev:statusinit --erase

 Removes all testing data and creates a fresh one:
 ./bin/console dev:statusinit -ec

 Removes all testing data and creates a fresh one 5 days in the past:
 ./bin/console dev:statusinit -ecd 5

 Be verbose (show the SQL executed):
 ./bin/console dev:statusinit --erase -v
</code></pre>
                </section>

            </div>
        </main>

        <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script src="http://goteofoundation.github.io/goteo/highlight/highlight.pack.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');
                // Syntax highlighting
                hljs.initHighlightingOnLoad();
            });
        </script>

    </body>
</html>
